@startuml
title Domain Model - Trust-Based System

package "Domain Models" {
    enum PlatformType {
        TELEGRAM
        VK
        DISCORD
        WHATSAPP
    }
    
    enum BanType {
        PERMANENT
        TEMPORARY
        KICK
        RESTRICT
    }
    
    class TrustRelation {
        +ID: int64
        +TrusterAdminID: string
        +TrusterPlatform: PlatformType
        +TrustedAdminID: string
        +TrustedPlatform: PlatformType
        +TargetChats: []ChatTarget
        +AutoSync: bool
        +SyncBanType: string
        +RequireConfirmation: bool
        +CreatedAt: time.Time
        +UpdatedAt: time.Time
        +IsActive: bool
    }
    
    class ChatTarget {
        +Platform: PlatformType
        +PlatformChatID: string
    }
    
    class AdminChatRelation {
        +ID: int64
        +AdminID: string
        +Platform: PlatformType
        +PlatformChatID: string
        +Role: string
        +CanBan: bool
        +IsActive: bool
        +CreatedAt: time.Time
        +UpdatedAt: time.Time
    }
    
    class UnifiedUser {
        +Platform: PlatformType
        +PlatformUserID: string
        +Username: *string
        +DisplayName: *string
        +AvatarURL: *string
        +Email: *string
        +Phone: *string
        +RawData: map[string]interface{}
    }
    
    class UnifiedChat {
        +Platform: PlatformType
        +PlatformChatID: string
        +ChatType: string
        +Title: *string
        +MemberCount: *int
        +RawData: map[string]interface{}
    }
    
    class BanEventRecord {
        +ID: int64
        +EventID: string
        +Platform: PlatformType
        +PlatformUserID: string
        +PlatformChatID: string
        +InitiatorAdminID: string
        +InitiatorPlatform: PlatformType
        +BanType: BanType
        +BanDuration: *int64
        +Reason: *string
        +EventTimestamp: time.Time
        +CreatedAt: time.Time
        +Metadata: map[string]interface{}
    }
    
    class SyncLog {
        +ID: int64
        +BanEventID: int64
        +TrustRelationID: *int64
        +SourceAdminID: string
        +SourcePlatform: PlatformType
        +SourceChatID: string
        +TargetPlatform: PlatformType
        +TargetChatID: string
        +TargetAdminID: string
        +BannedUserID: string
        +Status: string
        +ErrorMessage: *string
        +RetryCount: int
        +StartedAt: *time.Time
        +CompletedAt: *time.Time
        +CreatedAt: time.Time
    }
    
    TrustRelation *-- ChatTarget : target_chats
    TrustRelation -- PlatformType
    
    AdminChatRelation -- PlatformType
    
    BanEventRecord -- PlatformType
    BanEventRecord -- BanType
    
    SyncLog -- BanEventRecord
    SyncLog -- TrustRelation : optional
    
    note right of TrustRelation
        Admin A trusts Admin B.
        When B bans someone,
        they're banned in A's chats.
    end note
    
    note right of AdminChatRelation
        Tracks which admins
        moderate which chats.
        Used for self-sync.
    end note
    
    note right of SyncLog
        TrustRelationID is NULL
        for self-sync operations.
    end note
}

@enduml